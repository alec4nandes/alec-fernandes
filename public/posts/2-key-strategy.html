<!DOCTYPE html> <html lang="en"> <head> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7QM5KTX0XK"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-7QM5KTX0XK');
</script> <meta charset="UTF-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <meta name="type" property="og:type" content="website"/> <meta name="title" property="og:title" content="The 2-Key Strategy &mdash; FERN HAUS"/> <meta name="url" property="og:url" content="https-fern-haus-posts-2-key-strategy-html"/> <meta name="description" property="og:description" content="Keep your API keys safe when bundling client-side code. &mdash; Web Dev &mdash; API, security, HTTP restrictions, leaks, JavaScript, React, Webpack, Firebase, npm"/> <meta name="image" property="og:image" content="https://fern.haus/assets/feature-images/scott-webb-lnRPKo7Lo5Q-unsplash-min.jpg"/> <!-- twitter meta tags --> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@alec4nandes"/> <meta name="twitter:title" content="The 2-Key Strategy &mdash; FERN HAUS"/> <meta name="twitter:description" content="Keep your API keys safe when bundling client-side code. &mdash; Web Dev &mdash; API, security, HTTP restrictions, leaks, JavaScript, React, Webpack, Firebase, npm"/> <meta name="twitter:image" content="https://fern.haus/assets/feature-images/scott-webb-lnRPKo7Lo5Q-unsplash-min.jpg"/> <!-- end meta tags --> <title>The 2-Key Strategy &mdash; FERN HAUS</title> <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.png"/> <link rel="stylesheet" href="/css/home.css"/> </head> <body> <header> <div id="name-and-logo"> <button id="hamburger-menu-button"> <img src="/assets/hamburger-menu-icon.png"> </button> <a href="/"> <div id="logo-container"> <img id="header-logo" src="/assets/logo/fern-haus-site-logo.png" alt="Fern Haus logo: a house wrapped with two fern branches."> </div> <h1>Fern Haus</h1> </a> </div> <div id="hamburger-menu" class="closed"> <button id="close-menu"> <img src="/assets/hamburger-menu-close-icon.png"> </button> <h2>Menu</h2> <a href="/">Home</a> <a href="/categories">All Categories</a> <a href="/tags">All Tags</a> <a href="/about">About</a> <a href="/about">Contact</a> <section class="social-icons"> <a href="https://twitter.com/fern_haus_" target="_blank"> <img class="x-icon" src="/assets/social/x.png"/> </a> <a href="https://instagram.com/fern_haus_" target="_blank"> <img class="instagram-icon" src="/assets/social/instagram.png"/> </a> <a href="https://www.tiktok.com/@fern_haus_" target="_blank"> <img class="tiktok-icon" src="/assets/social/tiktok.png"/> </a> </section> </div> </header> <main> <section id="main-content"> <div id="posts-container"> <div id="latest-post"> <div class="single-post whole-post"> <div class="post-categories"> <a class="post-category-link" href="/categories/web-dev"> Web Dev </a> </div> <div class="whole-post-image-container"> <img src="/assets/feature-images/scott-webb-lnRPKo7Lo5Q-unsplash-min.jpg" alt=""/> </div> <p class="caption"> <em>Photo by <a href="https://unsplash.com/@scottwebb?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash" target="_blank" rel="noopener">Scott Webb</a> on <a href="https://unsplash.com/photos/red-blue-and-green-hanging-decor-lnRPKo7Lo5Q?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash" target="_blank" rel="noopener">Unsplash</a></em> </p> <h2>The 2-Key Strategy</h2> <p class="subtitle"> Keep your API keys safe when bundling client-side code. </p> <p class="date-posted"> 2023-11-07T12:03-08:00 </p> <p> Let’s jump right in! </p> <h3> The Problem </h3> <p class="blurb"> Bundling React code with Webpack can leak API keys into JavaScript files on the client side. Sometimes it’s unavoidable, so how do we handle it?</p> <h3>The Solution</h3> <p> We should set HTTP restrictions for all API keys. Most API settings allow this, but it also creates a new problem. Sometimes we need to add <em>localhost</em> to the restricted list when developing locally. Anyone else using localhost and our same port – for example <em>http://localhost:3000</em> – can also use our API key. </p> <p> We can protect our data from this nasty loophole by using two separate keys: a public one for production and a private one for development. Anyone can view the production key <strong>as long as it’s restricted to only the production URL.</strong> Hackers cannot replicate your production URL like they can with localhost, so the production key won’t work for them. </p> <p> The development key must remain completely secret – no bundling it into the deployed front-end code or uploading it to GitHub. If this accidentally happens, change the key immediately. This way a hacker on localhost and the same port number won’t be able to access your data. </p> <p> I personally keep both keys in a file hidden by <em>.gitignore</em>, and in my JavaScript I have the variable “apiKey” that I export across my code. For example: </p> <pre><code><xmp>// add private-file.js to .gitignore
import { developmentKey, productionKey } from "./private-file.js";

const IS_DEVELOPMENT = false,
	apiKey = IS_DEVELOPMENT ? developmentKey : productionKey;

await fetch(`https://fern.haus/my-cool-api/?key=${apiKey}`);

export { apiKey };
</xmp></code></pre> <p> Now I just need to make sure the variable <em>IS_DEVELOPMENT</em> is set to “false” before I publish or deploy any changes. This way the development key never leaks into the code, and you don’t have to replace it over and over again across many files. Just change one variable! </p> <h3> Conclusion </h3> <p> When building a dynamic single page app using React and packages like <em>firebase</em>, the API key unavoidably leaks into the bundled client-side code. By setting HTTP restrictions on not just one but two keys, we can publicly display our restricted production key while safely developing on localhost using our private development key. Don’t let unwanted third parties abuse your API quotas – adopt the 2-key strategy today! </p> <br/> </div> </div> </div> </section> <section id="sidebar" class="whole-post-sidebar"> <div id="categories-and-tags"> <a id="home-link" href="/">Go Home</a> <section class="social-icons"> <a href="https://twitter.com/fern_haus_" target="_blank"> <img class="x-icon" src="/assets/social/x.png"/> </a> <a href="https://instagram.com/fern_haus_" target="_blank"> <img class="instagram-icon" src="/assets/social/instagram.png"/> </a> <a href="https://www.tiktok.com/@fern_haus_" target="_blank"> <img class="tiktok-icon" src="/assets/social/tiktok.png"/> </a> </section> <div id="categories"> <div id="categories-sidebar-heading"> <h2>Post Categories</h2> <a class="all-categories-link" href="/categories">all categories</a> </div> <a class="category-link" href="/categories/web-dev"> Web Dev </a> </div> <div id="tags"> <h2>Post Tags</h2> <a href="/tags">all tags</a> <ul class="tags-list"> <li> <a class="tag-link" href="/tags/api"> API </a> </li> <li> <a class="tag-link" href="/tags/security"> security </a> </li> <li> <a class="tag-link" href="/tags/http-restrictions"> HTTP restrictions </a> </li> <li> <a class="tag-link" href="/tags/leaks"> leaks </a> </li> <li> <a class="tag-link" href="/tags/javascript"> JavaScript </a> </li> <li> <a class="tag-link" href="/tags/react"> React </a> </li> <li> <a class="tag-link" href="/tags/webpack"> Webpack </a> </li> <li> <a class="tag-link" href="/tags/firebase"> Firebase </a> </li> <li> <a class="tag-link" href="/tags/npm"> npm </a> </li> </ul> </div> </div> </section> </main> <footer> <p> <em>&copy; Alec Fernandes 2024</em> </p> <p> <a href="/about">About Fern Haus</a> </p> </footer> <script src="/src/scripts.js"></script> </body> </html>