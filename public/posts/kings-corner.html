<!-- TODO: update social image --> <!DOCTYPE html> <html lang="en"> <head> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7QM5KTX0XK"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-7QM5KTX0XK');
</script> <meta charset="UTF-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Kings Corner &mdash; FERN HAUS</title> <!-- meta_tags --> <meta name="type" property="og:type" content="website"/> <meta name="title" property="og:title" content="Kings Corner &mdash; FERN HAUS"/> <meta name="url" property="og:url" content="https-fern-haus-posts-kings-corner-html"/> <meta name="description" property="og:description" content="Learn about Firebase’s onSnapshot listener."/> <meta name="image" property="og:image" content="/assets/feature-images/kings-corner.jpg"/> <!-- twitter meta tags --> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@alec4nandes"/> <meta name="twitter:title" content="Kings Corner &mdash; FERN HAUS"/> <meta name="twitter:description" content="Learn about Firebase’s onSnapshot listener."/> <meta name="twitter:image" content="/assets/feature-images/kings-corner.jpg"/> <!-- end meta tags --> <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.ico"/> <link rel="stylesheet" href="/css/home.css"/> </head> <body> <header> <a href="/"> <div id="name-and-logo"> <img id="header-logo" src="/assets/logo/fern-haus-site-logo.png" alt="Fern Haus logo: a house wrapped with two fern branches."> <h1> Fern Haus </h1> </div> </a> </header> <main> <section id="posts-page"> <div id="posts-container"> <div id="latest-post"> <div class="single-post whole-post"> <div class="image-and-title"> <div class="feature-image full" style="background-image: url('/assets/feature-images/kings-corner.jpg');"></div> <h2>Kings Corner</h2> </div> <p class="subtitle"> Learn about Firebase’s onSnapshot listener. </p> <p class="date-posted"> 2023-05-26T13:52-07:00 </p> <p><a href="/arcade" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p class="blurb"> If I were a JavaScript teacher, my final project for the class would ask each student to build a card game of their choice. It would be a great exercise in data structuring – I personally love JavaScript's <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="noopener">Set data object</a> for projects like these – and the game logic requires state management and rule checking to ensure each play is valid. I know all this from experience building my own card game. </p> <p> Last year I taught some friends a game called <a href="/arcade" target="_blank" rel="noopener">Kings Corner</a> and discovered it was a hit after each new player couldn't seem to get enough. The easiest way to describe it is "multi-player solitaire" – you can <a href="/arcade" target="_blank" rel="noopener">learn more about the rules here</a> after registering for an account. </p> <p> Thanks to <a href="https://firebase.google.com/" target="_blank" rel="noopener">Google's Firebase</a> I was able to quickly set up account authentication and game data storage. What I really needed, however, was a database listener that could push each move update to the user interface in real time. I didn't want players to manually refresh the app to check if it's their turn. </p> <p> Thankfully, Firebase has <a href="https://firebase.google.com/docs/firestore/query-data/listen" target="_blank" rel="noopener">onSnapshot</a>. I set up this listener in my React app using the <a href="https://reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener">useEffect hook</a> and an empty array of dependencies. This creates the listener when the app initially loads, returning any changes detected in the game's database right after they're committed. </p> <pre><code><xmp>useEffect(
    () => {
        // load the game and listen for changes
        const theDoc = doc(firestore, "Games", gameKey),
            unsubscribe = onSnapshot(theDoc, gameplayCallback);
        // unsubscribe when the component unmounts
        return unsubscribe;
    },
    []
);
</xmp></code></pre> <p> Now I could see my opponent's moves as they made them, click by click or tap by tap. It was almost as fun as sitting at the table with friends and family – the only thing missing was the lively laughter and conversation, which is why I plan to include a chat feature in the near future. </p> <p> If no one's online to play, the computer can serve as a worthy adversary. The computer plays using a recursive function that keeps scanning cards until no more valid plays remain. The algorithm was simple to implement yet difficult to beat; I had created a perfectionist player that really keeps you on your toes. </p> <p> I loved turning a relatively unknown card game into a web app that people anywhere can enjoy, but the best reward has been the joy it's brought my loved ones. Hopefully interest keeps growing. If it does, I would like to start a player mailing list and even look into generating some ad revenue. </p> <p> My own advertising budget only stretches so far, so if you love <a href="/arcade" target="_blank" rel="noopener">Kings Corner</a> would you consider sharing <a href="/arcade" target="_blank" rel="noopener">this link</a> with your loved ones? Or if you have your own project ideas and need some help, please send me an email at <a href="mailto:al@fern.haus">al@fern.haus</a>. </p> <br/> </div> </div> </div> </section> <section id="sidebar" class="whole-post-sidebar"> <div id="categories-and-tags"> <a id="home-link" href="/">Go Home</a> <div id="categories"> <h2>Categories</h2> <a class="category-link" href="/categories/web-projects"> Web Projects </a> </div> <div id="tags"> <h2>Tags</h2> <ul class="tags-list"> <li> <a class="tag-link" href="/tags/cards"> cards </a> </li> <li> <a class="tag-link" href="/tags/games"> games </a> </li> <li> <a class="tag-link" href="/tags/firebase"> Firebase </a> </li> <li> <a class="tag-link" href="/tags/javascript"> JavaScript </a> </li> <li> <a class="tag-link" href="/tags/react"> React </a> </li> <li> <a class="tag-link" href="/tags/hooks"> hooks </a> </li> <li> <a class="tag-link" href="/tags/event-listeners"> event listeners </a> </li> </ul> </div> </div> </section> </main> <footer> <p> <em>&copy; Alec Fernandes 2024</em> </p> <p> <a href="/about">About Fern Haus</a> </p> </footer> <script src="/src/scripts.js"></script> </body> </html>