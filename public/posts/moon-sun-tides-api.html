<!DOCTYPE html> <html lang="en"> <head> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7QM5KTX0XK"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-7QM5KTX0XK');
</script> <meta charset="UTF-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <title>Moon-Sun-Tides API &mdash; FERN HAUS</title> <!-- meta_tags --> <meta name="type" property="og:type" content="website"/> <meta name="title" property="og:title" content="Moon-Sun-Tides API &mdash; FERN HAUS"/> <meta name="url" property="og:url" content="https-fern-haus-posts-moon-sun-tides-api-html"/> <meta name="description" property="og:description" content="Read the code documentation before you copy and paste. &mdash; Web Projects &mdash; API, JavaScript, dates, documentation, pseudocode, template literals, nature"/> <meta name="image" property="og:image" content="https://fern.haus/assets/feature-images/moon-sun-tides-api.jpg"/> <!-- twitter meta tags --> <meta name="twitter:card" content="summary_large_image"/> <meta name="twitter:site" content="@alec4nandes"/> <meta name="twitter:title" content="Moon-Sun-Tides API &mdash; FERN HAUS"/> <meta name="twitter:description" content="Read the code documentation before you copy and paste. &mdash; Web Projects &mdash; API, JavaScript, dates, documentation, pseudocode, template literals, nature"/> <meta name="twitter:image" content="https://fern.haus/assets/feature-images/moon-sun-tides-api.jpg"/> <!-- end meta tags --> <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.ico"/> <link rel="stylesheet" href="/css/home.css"/> </head> <body> <header> <a href="/"> <div id="name-and-logo"> <img id="header-logo" src="/assets/logo/fern-haus-site-logo.png" alt="Fern Haus logo: a house wrapped with two fern branches."> <h1> Fern Haus </h1> </div> </a> </header> <main> <section id="main-content"> <div id="posts-container"> <div id="latest-post"> <div class="single-post whole-post"> <div class="whole-post-image-container"> <img src="/assets/feature-images/moon-sun-tides-api.jpg" alt=""/> </div> <p class="caption"> <em>Photo by <a href="https://unsplash.com/@tegethoff?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Mark Tegethoff</a> on <a href="https://unsplash.com/photos/NbgQfUvKFE0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></em> </p> <h2>Moon-Sun-Tides API</h2> <p class="subtitle"> Read the code documentation before you copy and paste. </p> <p class="date-posted"> 2023-06-02T13:52-07:00 </p> <p><a href="/moon-sun-tides" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p class="blurb"> Creating <a href="/moon-sun-tides" target="_blank" rel="noopener">my own API</a> proved that rarely anything in programming is accomplished alone â€“ instead it's built on the backs of the many engineers that came before. Another lesson it taught me: don't just copy code from <a href="https://stackoverflow.com" target="_blank" rel="noopener">Stack Overflow</a>. This online forum is only a starting point, and programmers should <strong>always</strong> read a solution's original documentation to really understand what they're working with. </p> <p> The API that I built combined, in my opinion, the most requested time data for natural phenomena: sunsets, sunrises, full and new moons, and tides both high and low. I was surprised a single simple endpoint for all this data didn't already exist. Maybe I didn't dig deep enough, or maybe I didn't want to. What I wanted instead was to create my own. </p> <p> The online forums helped me find three separate sources for this project: </p> <ul> <li><a href="https://sunrise-sunset.org/api" target="_blank" rel="noopener">Sunrise-Sunset</a></li> <li><a href="https://www.npmjs.com/package/lune" target="_blank" rel="noopener">lune (npm)</a></li> <li><a href="https://api.tidesandcurrents.noaa.gov/api/prod/" target="_blank" rel="noopener">NOAA Tides and Currents</a></li> </ul> <p> These endpoints had already done the hard work of observing the natural world. Now all I needed to do was make one simple API from these three more complicated ones. </p> <p> Stack Overflow had great examples of each one, and all the data seemed correct and uniform with one exception: <a href="https://api.tidesandcurrents.noaa.gov/api/prod/" target="_blank" rel="noopener">NOAA's Tides API</a>. The example I found returned dates and times in the coordinates' local timezone (without telling the timezone), but I needed them to be in the same <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" target="_blank" rel="noopener">UTC</a> timezone of the sun and moon times. </p> <p> <em> Side note: If users want to convert UTC timestamps to ones in their local timezones, they can simply create new JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener">Date objects</a> from the timestamps: </em> </p> <pre><code><xmp>new Date("2023-01-10 13:00 +0");
// prints "Tue Jan 10 2023 05:00:00 GMT-0800 (Pacific Standard Time)"
// since I'm in California.
</xmp></code></pre> <h3>Solving the problem</h3> <p> This situation got me thinking about how to convert a local time to a UTC timestamp when I knew the coordinates but not the timezone. I came up with the following approach in <a href="https://en.wikipedia.org/wiki/Pseudocode" target="_blank" rel="noopener">pseudocode</a>: </p> <ul> <li>Calculate the timezone offset from UTC (for example, Pacific Standard Time = -8).</li> <li>Create <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" target="_blank" rel="noopener">a template literal</a> with the local date, time and timezone offset: <pre><code><xmp>`${date} ${time} ${offset}`</xmp></code></pre></li> <li>Pass the resulting string into <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener">a new Date object</a>.</li> <li>Get the UTC timestamp from this Date object with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString" target="_blank" rel="noopener">.toUTCString()</a> method.</li> </ul> <p> There is a nifty node package called <a href="https://www.npmjs.com/package/geo-tz" target="_blank" rel="noopener">geo-tz</a> that takes coordinates and returns their timezone offset, which let me successfully implement the pseudocode above. Hooray, the function worked! But did I really need to do all those extra steps? </p> <h3>An easier solution</h3> Even though the approach above works, it's redundant for the tides API. I don't need to convert any timezones because NOAA's API can do it for me with its <a href="https://api.tidesandcurrents.noaa.gov/api/prod/#timezone" target="_blank" rel="noopener">time_zone</a> parameter. The example endpoint I found on the forums set this value as <em>lst</em> for <em>Local Standard Time</em>, but the original documentation listed another option: <em>gmt</em> for <em>Greenwich Mean Time</em>, aka <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" target="_blank" rel="noopener">UTC</a>. <p> I wouldn't have known this was possible if I hadn't studied the code docs. <strong>Always</strong> review the original documentation for any language, class or API that you use. Stack Overflow is a great tool for pointing programmers in the right direction, but it's up to them to go further. They need to know <strong>both</strong> that a solution works <strong>and how</strong> it can work better for their specific project. </p> <br/> </div> </div> </div> </section> <section id="sidebar" class="whole-post-sidebar"> <div id="categories-and-tags"> <a id="home-link" href="/">Go Home</a> <div id="categories"> <h2>Categories</h2> <a class="category-link" href="/categories/web-projects"> Web Projects </a> </div> <div id="tags"> <h2>Tags</h2> <ul class="tags-list"> <li> <a class="tag-link" href="/tags/api"> API </a> </li> <li> <a class="tag-link" href="/tags/javascript"> JavaScript </a> </li> <li> <a class="tag-link" href="/tags/dates"> dates </a> </li> <li> <a class="tag-link" href="/tags/documentation"> documentation </a> </li> <li> <a class="tag-link" href="/tags/pseudocode"> pseudocode </a> </li> <li> <a class="tag-link" href="/tags/template-literals"> template literals </a> </li> <li> <a class="tag-link" href="/tags/nature"> nature </a> </li> </ul> </div> </div> </section> </main> <footer> <p> <em>&copy; Alec Fernandes 2024</em> </p> <p> <a href="/about">About Fern Haus</a> </p> </footer> <script src="/src/scripts.js"></script> </body> </html>