<html lang="en"> <head> <meta charset="UTF-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <!-- meta tags --> <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.ico"/> <link rel="stylesheet" href="/css/style.css"/> <link rel="stylesheet" href="/css/header-menu.css"/> <link rel="stylesheet" href="/css/article.css"/> </head> <body> <header class="small-header-container"> <div class="small-header"> <h1> <a href="/">Alec Fernandes</a> </h1> <h2>tag: javascript</h2> </div> </header> <div class="subscribe-container"> <div class="subscribe"> <button class="open-nav" onclick="toggleNavMenu(true)"> <img src="/assets/icons8-menu-64.png" alt=""/> </button> <nav class="closed"> <button class="close-nav" onclick="toggleNavMenu(false)"> <img src="/assets/icons8-close-30.png" alt=""/> </button> <ul> <li> <a href="/">Home</a> </li> <li> <a href="/blog">Blog</a> </li> <li> <a href="/contact">Contact</a> </li> </ul> <h2 class="nav-heading"> Projects <a href="https://github.com/alec4nandes" target="_blank" rel="noopener" > <img src="/assets/icons8-github-30.png" alt=""/> </a> </h2> <ul> <li> <a href="/blog/prova-lab.html"> prova lab </a> </li> <li> <a href="/blog/mushrooms.html"> mushrooms </a> </li> <li> <a href="/blog/moon-sun-tides-api.html"> moon sun tides api </a> </li> <li> <a href="/blog/kings-corner.html"> kings corner </a> </li> <li> <a href="/blog/dharma-gem.html"> dharma gem </a> </li> <li> <a href="/blog/iching.html"> iching </a> </li> <li> <a href="/blog/timers.html"> timers </a> </li> <li> <a href="/blog/dharma-deck.html"> dharma deck </a> </li> <li> <a href="/blog/buddhist-ebook.html"> buddhist ebook </a> </li> </ul> <h2 class="nav-heading">Graphic Design</h2> <ul> <li> <a href="/gallery">Gallery</a> </li> </ul> <h2 class="nav-heading">Tags</h2> <ul> <li> <a href="/tags/3d.html">3D</a> </li> <li> <a href="/tags/api.html">API</a> </li> <li> <a href="/tags/ariana-huffington.html">Ariana Huffington</a> </li> <li> <a href="/tags/buddhism.html">Buddhism</a> </li> <li> <a href="/tags/css.html">CSS</a> </li> <li> <a href="/tags/china.html">China</a> </li> <li> <a href="/tags/dom.html">DOM</a> </li> <li> <a href="/tags/dry.html">DRY</a> </li> <li> <a href="/tags/diana-smith.html">Diana Smith</a> </li> <li> <a href="/tags/google-firebase.html">Google Firebase</a> </li> <li> <a href="/tags/google-maps.html">Google Maps</a> </li> <li> <a href="/tags/html.html">HTML</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/kabbalah.html">Kabbalah</a> </li> <li> <a href="/tags/mushroom-observer.html">Mushroom Observer</a> </li> <li> <a href="/tags/pomodoro.html">Pomodoro</a> </li> <li> <a href="/tags/prova-lab.html">Prova Lab</a> </li> <li> <a href="/tags/react.html">React</a> </li> <li> <a href="/tags/san-francisco.html">San Francisco</a> </li> <li> <a href="/tags/sass.html">Sass</a> </li> <li> <a href="/tags/taoism.html">Taoism</a> </li> <li> <a href="/tags/vpn.html">VPN</a> </li> <li> <a href="/tags/animations.html">animations</a> </li> <li> <a href="/tags/art.html">art</a> </li> <li> <a href="/tags/cards.html">cards</a> </li> <li> <a href="/tags/coupling.html">coupling</a> </li> <li> <a href="/tags/dates.html">dates</a> </li> <li> <a href="/tags/design.html">design</a> </li> <li> <a href="/tags/documentation.html">documentation</a> </li> <li> <a href="/tags/ebooks.html">eBooks</a> </li> <li> <a href="/tags/epubcheck.html">epubcheck</a> </li> <li> <a href="/tags/event-listeners.html">event listeners</a> </li> <li> <a href="/tags/free.html">free</a> </li> <li> <a href="/tags/free-downloads.html">free downloads</a> </li> <li> <a href="/tags/games.html">games</a> </li> <li> <a href="/tags/geolocation.html">geolocation</a> </li> <li> <a href="/tags/graphic-design.html">graphic design</a> </li> <li> <a href="/tags/hooks.html">hooks</a> </li> <li> <a href="/tags/innerheight.html">innerHeight</a> </li> <li> <a href="/tags/innovation.html">innovation</a> </li> <li> <a href="/tags/landing-pages.html">landing pages</a> </li> <li> <a href="/tags/layouts.html">layouts</a> </li> <li> <a href="/tags/libraries.html">libraries</a> </li> <li> <a href="/tags/mushrooms.html">mushrooms</a> </li> <li> <a href="/tags/nature.html">nature</a> </li> <li> <a href="/tags/offsetheight.html">offsetHeight</a> </li> <li> <a href="/tags/parallax-scrolling.html">parallax scrolling</a> </li> <li> <a href="/tags/productivity.html">productivity</a> </li> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/pseudocode.html">pseudocode</a> </li> <li> <a href="/tags/scrollheight.html">scrollHeight</a> </li> <li> <a href="/tags/tarot.html">tarot</a> </li> <li> <a href="/tags/template-literals.html">template literals</a> </li> <li> <a href="/tags/validation.html">validation</a> </li> <li> <a href="/tags/workouts.html">workouts</a> </li> <li> <a href="/tags/yin-and-yang.html">yin and yang</a> </li> </ul> </nav> <div class="social-icons"> <a class="sticky-contact-link" href="/contact"> contact me&nbsp; </a> <a href="https://twitter.com/alec4nandes" target="_blank" rel="noopener"> <img src="/assets/icons8-twitter-32.png" alt="Twitter icon of little bird"/> </a> <a href="https://instagram.com/alec4nandes" target="_blank" rel="noopener"> <img src="/assets/icons8-instagram-32.png" alt="Instagram icon of polaroid camera"/> </a> </div> </div> </div> <main> <article> <h2 class="title"> <a href="/blog/javascript-different-size-properties.html">JavaScript's different size properties for DOM elements</a> </h2> <h3 class="subtitle">Learn about the dimensional data attached to each JavaScript-selected element.</h3> <p class="date-posted">January 25, 2023 at 12:19 pm PST</p> <figure> <img src="https://firebasestorage.googleapis.com/v0/b/node-blog-369520.appspot.com/o/javascript-different-size-properties%2Fmilad-fakurian-PpgY7sjpf_0-unsplash-min.jpg?alt=media&token=7d6e356b-3307-4a8a-8202-40f05c02b5a3"/> <figcaption>Photo by <a href="https://unsplash.com/@fakurian?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Milad Fakurian</a> on <a href="https://unsplash.com/photos/PpgY7sjpf_0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></figcaption> </figure> <div><p> I wrote the following code that changes an element's CSS properties based on the user's scroll position. Normally the element is <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/position#fixed" target="_blank" rel="noopener">fixed</a> to the bottom of the screen, but I didn't want it to overlap with the footer once the user scrolls to the bottom of the page. </p> <p> The example uses different height properties for different elements. For the browser <em>window</em> I grab the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/innerHeight" target="_blank" rel="noopener">innerHeight</a> property. For the <em>body</em> height I take the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight" target="_blank" rel="noopener">scrollHeight</a> property. And for the <em>footer</em> height I use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight" target="_blank" rel="noopener">offsetHeight</a> property. </p> <p> Each one of these properties has subtle differences. <strong>Window.innerHeight</strong> doesn't take into account any content that overflows the browser <em>window</em> &mdash; it only measures the height of the viewport. To get the no-overflow height for other elements, including padding and borders, use <strong>Element.offsetHeight</strong>. To get the height of an element's scrollable content, use <strong>Element.scrollHeight</strong>. </p> <p> There are also corresponding width properties: </p> <ul> <li> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/innerWidth" target="_blank" rel="noopener">innerWidth</a> </li> <li> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollWidth" target="_blank" rel="noopener">scrollWidth</a> </li> <li> <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetWidth" target="_blank" rel="noopener">offsetWidth</a> </li> </ul> <pre style="width: 100%; background-color: #edf6ff; border-radius: 10px; box-sizing: border-box; overflow-x: auto; padding: 10px;"><code><xmp>stopFixedScrollAboveFooter();

function stopFixedScrollAboveFooter() {
    stopFixedScrollAboveFooterHelper();
    window.onscroll = stopFixedScrollAboveFooterHelper;
}

function stopFixedScrollAboveFooterHelper() {
    const {scrollY: scrollPos, innerHeight: screenHeight} = window,
        bodyHeight = document.body.scrollHeight,
        footerHeight = document.querySelector("footer").offsetHeight,
        isRemoveFixed = scrollPos + screenHeight > bodyHeight - footerHeight,
        fixedElem = document.querySelector(".fixed");
    fixedElem.style.position = isRemoveFixed ? "absolute" : "fixed";
    fixedElem.style.bottom = isRemoveFixed ? `${footerHeight}px` : 0;
}
</xmp></code></pre> <p> Thanks for reading! If you liked this post, be sure to subscribe for more in the navigation bar at the top of the page. </p></div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/dom.html">DOM</a> </li> <li> <a href="/tags/innerheight.html">innerHeight</a> </li> <li> <a href="/tags/scrollheight.html">scrollHeight</a> </li> <li> <a href="/tags/offsetheight.html">offsetHeight</a> </li> </ul> </div> <button class="share-button" onclick="copyLink()"> share <img src="/assets/icons8-share-24.png" alt=""/> </button> </article> <article> <h2 class="title"> <a href="/blog/moon-sun-tides-api.html">Moon-Sun-Tides API</a> </h2> <h3 class="subtitle">Read the code documentation before you copy and paste.</h3> <p class="date-posted">January 25, 2023 at 12:19 pm PST</p> <figure> <img src="https://firebasestorage.googleapis.com/v0/b/node-blog-369520.appspot.com/o/moon-sun-tides-api%2Fmoons-min.jpg?alt=media&token=57695ad7-51b0-4a9f-a3a0-d31d87b44373"/> <figcaption>Photo by <a href="https://unsplash.com/@tegethoff?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Mark Tegethoff</a> on <a href="https://unsplash.com/photos/NbgQfUvKFE0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></figcaption> </figure> <div><p><a href="/moon-sun-tides" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p> Creating <a href="/moon-sun-tides" target="_blank" rel="noopener">my own API</a> proved that rarely anything in programming is accomplished alone – instead it's built on the backs of the many engineers that came before. Another lesson it taught me: don't just copy code from <a href="https://stackoverflow.com" target="_blank" rel="noopener">Stack Overflow</a>. This online forum is only a starting point, and programmers should <strong>always</strong> read a solution's original documentation to really understand what they're working with. </p> <p> The API that I built combined, in my opinion, the most requested time data for natural phenomena: sunsets, sunrises, full and new moons, and tides both high and low. I was surprised a single simple endpoint for all this data didn't already exist. Maybe I didn't dig deep enough, or maybe I didn't want to. What I wanted instead was to create my own. </p> <p> The online forums helped me find three separate sources for this project: </p> <ul> <li><a href="https://sunrise-sunset.org/api" target="_blank" rel="noopener">Sunrise-Sunset</a></li> <li><a href="https://www.npmjs.com/package/lune" target="_blank" rel="noopener">lune (npm)</a></li> <li><a href="https://api.tidesandcurrents.noaa.gov/api/prod/" target="_blank" rel="noopener">NOAA Tides and Currents</a></li> </ul> <p> These endpoints had already done the hard work of observing the natural world. Now all I needed to do was make one simple API from these three more complicated ones. </p> <p> Stack Overflow had great examples of each one, and all the data seemed correct and uniform with one exception: <a href="https://api.tidesandcurrents.noaa.gov/api/prod/" target="_blank" rel="noopener">NOAA's Tides API</a>. The example I found returned dates and times in the coordinates' local timezone (without telling the timezone), but I needed them to be in the same <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" target="_blank" rel="noopener">UTC</a> timezone of the sun and moon times. </p> <p> <em> Side note: If users want to convert UTC timestamps to ones in their local timezones, they can simply create new JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener">Date objects</a> from the timestamps: </em> </p> <pre><code><xmp>new Date("2023-01-10 13:00 +0");
// prints "Tue Jan 10 2023 05:00:00 GMT-0800 (Pacific Standard Time)"
// since I'm in California.
</xmp></code></pre> <h3>Solving the problem</h3> <p> This situation got me thinking about how to convert a local time to a UTC timestamp when I knew the coordinates but not the timezone. I came up with the following approach in <a href="https://en.wikipedia.org/wiki/Pseudocode" target="_blank" rel="noopener">pseudocode</a>: </p> <ul> <li>Calculate the timezone offset from UTC (for example, Pacific Standard Time = -8).</li> <li>Create <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" target="_blank" rel="noopener">a template literal</a> with the local date, time and timezone offset: <pre><code><xmp>`${date} ${time} ${offset}`</xmp></code></pre></li> <li>Pass the resulting string into <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener">a new Date object</a>.</li> <li>Get the UTC timestamp from this Date object with the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toUTCString" target="_blank" rel="noopener">.toUTCString()</a> method.</li> </ul> <p> There is a nifty node package called <a href="https://www.npmjs.com/package/geo-tz" target="_blank" rel="noopener">geo-tz</a> that takes coordinates and returns their timezone offset, which let me successfully implement the pseudocode above. Hooray, the function worked! But did I really need to do all those extra steps? </p> <h3>An easier solution</h3> Even though the approach above works, it's redundant for the tides API. I don't need to convert any timezones because NOAA's API can do it for me with its <a href="https://api.tidesandcurrents.noaa.gov/api/prod/#timezone" target="_blank" rel="noopener">time_zone</a> parameter. The example endpoint I found on the forums set this value as <em>lst</em> for <em>Local Standard Time</em>, but the original documentation listed another option: <em>gmt</em> for <em>Greenwich Mean Time</em>, aka <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" target="_blank" rel="noopener">UTC</a>. <p> I wouldn't have known this was possible if I hadn't studied the code docs. <strong>Always</strong> review the original documentation for any language, class or API that you use. Stack Overflow is a great tool for pointing programmers in the right direction, but it's up to them to go further. They need to know <strong>both</strong> that a solution works <strong>and how</strong> it can work better for their specific project. </p></div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/api.html">API</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/dates.html">dates</a> </li> <li> <a href="/tags/documentation.html">documentation</a> </li> <li> <a href="/tags/pseudocode.html">pseudocode</a> </li> <li> <a href="/tags/template-literals.html">template literals</a> </li> <li> <a href="/tags/nature.html">nature</a> </li> </ul> </div> <button class="share-button" onclick="copyLink()"> share <img src="/assets/icons8-share-24.png" alt=""/> </button> </article> <article> <h2 class="title"> <a href="/blog/kings-corner.html">Kings Corner</a> </h2> <h3 class="subtitle">Learn about Firebase’s onSnapshot listener.</h3> <p class="date-posted">January 25, 2023 at 12:19 pm PST</p> <figure> <img src="https://firebasestorage.googleapis.com/v0/b/node-blog-369520.appspot.com/o/kings-corner%2Fkings-corner-logo-post-min.jpg?alt=media&token=f9f494d8-7c97-44ca-bc9b-962347b1ba3c"/> <figcaption>The logo I designed for <a href="/arcade" target="_blank" rel="noopener">Kings Corner</a>.</figcaption> </figure> <div><p><a href="/arcade" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p> If I were a JavaScript teacher, my final project for the class would ask each student to build a card game of their choice. It would be a great exercise in data structuring – I personally love JavaScript's <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set" target="_blank" rel="noopener">Set data object</a> for projects like these – and the game logic requires state management and rule checking to ensure each play is valid. I know all this from experience building my own card game. </p> <p> Last year I taught some friends a game called <a href="/arcade" target="_blank" rel="noopener">Kings Corner</a> and discovered it was a hit after each new player couldn't seem to get enough. The easiest way to describe it is "multi-player solitaire" – you can <a href="/arcade" target="_blank" rel="noopener">learn more about the rules here</a> after registering for an account. </p> <p> Thanks to <a href="https://firebase.google.com/" target="_blank" rel="noopener">Google's Firebase</a> I was able to quickly set up account authentication and game data storage. What I really needed, however, was a database listener that could push each move update to the user interface in real time. I didn't want players to manually refresh the app to check if it's their turn. </p> <p> Thankfully, Firebase has <a href="https://firebase.google.com/docs/firestore/query-data/listen" target="_blank" rel="noopener">onSnapshot</a>. I set up this listener in my React app using the <a href="https://reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener">useEffect hook</a> and an empty array of dependencies. This creates the listener when the app initially loads, returning any changes detected in the game's database right after they're committed. </p> <pre><code><xmp>useEffect(
    () => {
        // load the game and listen for changes
        const theDoc = doc(firestore, "Games", gameKey),
            unsubscribe = onSnapshot(theDoc, gameplayCallback);
        // unsubscribe when the component unmounts
        return unsubscribe;
    },
    []
);
</xmp></code></pre> <p> Now I could see my opponent's moves as they made them, click by click or tap by tap. It was almost as fun as sitting at the table with friends and family – the only thing missing was the lively laughter and conversation, which is why I plan to include a chat feature in the near future. </p> <p> If no one's online to play, the computer can serve as a worthy adversary. The computer plays using a recursive function that keeps scanning cards until no more valid plays remain. The algorithm was simple to implement yet difficult to beat; I had created a perfectionist player that really keeps you on your toes. </p> <p> I loved turning a relatively unknown card game into a web app that people anywhere can enjoy, but the best reward has been the joy it's brought my loved ones. Hopefully interest keeps growing. If it does, I would like to start a player mailing list and even look into generating some ad revenue. </p> <p> My own advertising budget only stretches so far, so if you love <a href="/arcade" target="_blank" rel="noopener">Kings Corner</a> would you consider sharing <a href="/arcade" target="_blank" rel="noopener">this link</a> with your loved ones? Or if you have your own project ideas and need some help, please send me an email at <a href="mailto:al@fern.haus">al@fern.haus</a>. </p></div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/cards.html">cards</a> </li> <li> <a href="/tags/games.html">games</a> </li> <li> <a href="/tags/google-firebase.html">Google Firebase</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/react.html">React</a> </li> <li> <a href="/tags/hooks.html">hooks</a> </li> <li> <a href="/tags/event-listeners.html">event listeners</a> </li> </ul> </div> <button class="share-button" onclick="copyLink()"> share <img src="/assets/icons8-share-24.png" alt=""/> </button> </article> <article> <h2 class="title"> <a href="/blog/iching.html">I-Ching</a> </h2> <h3 class="subtitle">Consult an ancient oracle on a modern webpage.</h3> <p class="date-posted">January 25, 2023 at 12:19 pm PST</p> <figure> <img src="https://firebasestorage.googleapis.com/v0/b/node-blog-369520.appspot.com/o/iching%2Fyin-yang-min.jpg?alt=media&token=898e0ab7-828c-4a06-976f-0344f2da7dad"/> <figcaption>Photo by <a href="https://unsplash.com/@hrustall?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Дмитрий Хрусталев-Григорьев</a> on <a href="https://unsplash.com/photos/CFqUdmzzti0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></figcaption> </figure> <div><p><a href="/iching" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p> It's difficult to live a spiritual life in Southern California. Here toxic body images and inflated egos are unavoidable, but a Taoist outlook keeps me humble. How can you be upset or self-conscious when you realize nothing lasts forever? To the Taoist, life is nothing more than a rhythmic tidal current of lows and highs, yin and yang. </p> <p> Yet one of the few things to remain constant over the past three millennia is the I-Ching. It is a divinatory reference for China's ancient oracles and one of the most famous texts of Taoism. Personally, I find it to be a bit too esoteric (and that's saying a lot!), but I'm interested in the parts of the I-Ching that are related to computer science, mainly binary code. </p> <p> The old text combines the binary of yin and yang in triplicate to form <a href="/iching/bagua" target="_blank" rel="noopener">eight classical elements</a> (2^3=8), then joins these elements into <a href="/iching/text" target="_blank" rel="noopener">64 different pairs</a> (8^2=64) called hexagrams. I found it mathematically fascinating and decided to write my own JavaScript program for telling fortunes with the I-Ching. </p> <p> The divination method and logic were pretty straightforward and therefore easy to implement as JavaScript, but making it all look realistic was a different story. Modern I-Ching readings involve flipping three coins six times to get a hexagram, and I had a vision of three virtual coins flipping and falling on the screen before the user sees a reading. It was an enjoyable design challenge that combined separate CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations/Using_CSS_animations" target="_blank" rel="noopener">animations</a> at random <a href="https://developer.mozilla.org/en-US/docs/Web/API/setInterval" target="_blank" rel="noopener">intervals</a> set with JavaScript. I wrote a post about <a href="/post/?id=rotate-2-sided-object-show-both-sides-CSS" target="_blank" rel="noopener">the flip animations here</a>. </p> <p> What was once a single boring click is now a dynamic experience. The user feels even more actively involved in their reading by watching the coin flips that will determine their fate. I highly encourage you to <a href="/iching/cast" target="_blank" rel="noopener">check it out here</a>. Who knows? You might end up with some good advice. </p></div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/css.html">CSS</a> </li> <li> <a href="/tags/animations.html">animations</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/taoism.html">Taoism</a> </li> <li> <a href="/tags/china.html">China</a> </li> <li> <a href="/tags/yin-and-yang.html">yin and yang</a> </li> </ul> </div> <button class="share-button" onclick="copyLink()"> share <img src="/assets/icons8-share-24.png" alt=""/> </button> </article> <article> <h2 class="title"> <a href="/blog/timers.html">Timers</a> </h2> <h3 class="subtitle">Learn how to repeatedly play the same sound file on mobile using setInterval in JS.</h3> <p class="date-posted">January 25, 2023 at 12:18 pm PST</p> <figure> <img src="https://firebasestorage.googleapis.com/v0/b/node-blog-369520.appspot.com/o/timers%2Fage-barros-rBPOfVqROzY-unsplash-min.jpg?alt=media&token=7396a9dd-ac76-4324-b968-e71322bf25ef"/> <figcaption>Photo by <a href="https://unsplash.com/@agebarros?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Agê Barros</a> on <a href="https://unsplash.com/photos/rBPOfVqROzY?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></figcaption> </figure> <div><p><a href="/timers" target="_blank" rel="noopener"><em>View this project.</em></a></p> <p> Okay fine. I admit it. I'm not perfect. And before you inevitably try to convince me otherwise, I'll reveal my biggest flaw in the workplace: I'm not good at taking breaks. </p> <p> It's hard to stop myself when I'm caught in a creative flow. I was also raised to be an overachiever, so for a long time I saw taking more breaks as being less productive. Only after pushing myself to <a href="https://www.today.com/health/arianna-huffington-collapse-exhaustion-was-wake-call-2D79644042" target="_blank" rel="noopener">pre-2007 Arianna Huffington stress levels</a> did I realize the importance of taking regular breaks. </p> <p> My favorite method for achieving this is the <em>Pomodoro Timer</em>. It alerts you to take a short break after a fixed interval of time. I find I stay the most creative by taking five minute breaks after every 25 minutes or so of work. At first 25 minutes didn't even seem like enough time to get settled, but I was amazed to discover how much I could get done in that span when I quickly and regularly refreshed myself. It improved my workflow so much that I decided to design <a href="/timers/pomodoro" target="_blank" rel="noopener">my own Pomodoro Timer</a>. </p> <p> The implementation wasn't anything too complicated &mdash; just alternating <a href="https://developer.mozilla.org/en-US/docs/Web/API/setInterval" target="_blank" rel="noopener">setIntervals</a> marked by two distinct sounds. I also used this approach to create <a href="/timers/workout" target="_blank" rel="noopener">a more flexible workout timer</a> that announces what number repetition the user is starting. All of this worked great on desktop, but mobile was a different story. </p> <p> It turns out on mobile you can automatically play a JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement/Audio" target="_blank" rel="noopener">Audio object</a> (such as the timer's beep), but without further user interaction (such as clicking a button) the sound only plays once. This was a big problem for a web app that played automated beeps after several intervals of work and break time. </p> <p> After identifying the issue above with the help of <a href="https://stackoverflow.com" target="_blank" rel="noopener">Stack Overflow</a>, it occurred to me that I could automatically play the same sound multiple times on mobile devices if I created arrays full of separate Audio objects that play the same sound. Iterating through these identical playbacks would trick the browser into thinking it's playing a brand new sound automatically for the first time. </p> <pre><code><xmp>/*
    Mobile browsers will not play sounds repeatedly with setInterval.
    Create arrays of Audio objects to play separately.
*/

const breakBeeps = [],
    workBeeps = [];

for (let i = 0; i < 24; i++) {
    breakBeeps.push(new Audio("./audio/break-start-beep.mp3"));
    workBeeps.push(new Audio("./audio/break-end-beep.mp3"));
}
</xmp></code></pre> <p> I'm happy to say this hack worked, and now I can successfully use <a href="/timers" target="_blank" rel="noopener">both timers</a> when I'm away from my desktop. If you haven't ever tried integrating a productivity timer into your workflow, I highly suggest you do. Let me know how it goes by sending an email to <a href="mailto:al@fern.haus">al@fern.haus</a>. </p> </div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/productivity.html">productivity</a> </li> <li> <a href="/tags/pomodoro.html">Pomodoro</a> </li> <li> <a href="/tags/workouts.html">workouts</a> </li> <li> <a href="/tags/ariana-huffington.html">Ariana Huffington</a> </li> </ul> </div> <button class="share-button" onclick="copyLink()"> share <img src="/assets/icons8-share-24.png" alt=""/> </button> </article> </main> <a href="/contact" class="sticky-contact"> <img src="/assets/mail-icon.png" alt="" /> </a> <footer> <div id="footer-container"> <a href="/">home</a> <a href="/blog">blog</a> <a href="/contact">contact</a> </div> </footer> <script src="/src/scripts.js"></script> </body> </html>