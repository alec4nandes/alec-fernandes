<html lang="en"> <head> <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7QM5KTX0XK"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-7QM5KTX0XK');
</script> <meta charset="UTF-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <!-- meta tags --> <link rel="icon" type="image/x-icon" href="/assets/logo/favicon.ico"/> <link rel="stylesheet" href="/css/style.css"/> <link rel="stylesheet" href="/css/header-menu.css"/> <link rel="stylesheet" href="/css/article.css"/> </head> <body> <header class="small-header-container"> <div class="small-header"> <h1> <a href="/">Alec Fernandes</a> </h1> <h2>tag: http restrictions</h2> </div> </header> <div class="subscribe-container"> <div class="subscribe"> <button class="open-nav" onclick="toggleNavMenu(true)"> <img src="/assets/icons8-menu-64.png" alt=""/> </button> <nav class="closed"> <button class="close-nav" onclick="toggleNavMenu(false)"> <img src="/assets/icons8-close-30.png" alt=""/> </button> <ul> <li> <a href="/">Home</a> </li> <li> <a href="/blog">Blog</a> </li> <li> <a href="/contact">Contact</a> </li> </ul> <h2 class="nav-heading"> Projects <a href="https://github.com/alec4nandes" target="_blank" rel="noopener" > <img src="/assets/icons8-github-30.png" alt=""/> </a> </h2> <ul> <li> <a href="/blog/prova-lab.html"> prova lab </a> </li> <li> <a href="/blog/mushrooms.html"> mushrooms </a> </li> <li> <a href="/blog/moon-sun-tides-api.html"> moon sun tides api </a> </li> <li> <a href="/blog/kings-corner.html"> kings corner </a> </li> <li> <a href="/blog/dharma-gem.html"> dharma gem </a> </li> <li> <a href="/blog/iching.html"> iching </a> </li> <li> <a href="/blog/timers.html"> timers </a> </li> <li> <a href="/blog/dharma-deck.html"> dharma deck </a> </li> <li> <a href="/blog/buddhist-ebook.html"> buddhist ebook </a> </li> </ul> <h2 class="nav-heading">Graphic Design</h2> <ul> <li> <a href="/gallery">Gallery</a> </li> </ul> <h2 class="nav-heading">Tags</h2> <ul> <li> <a href="/tags/3d.html">3D</a> </li> <li> <a href="/tags/animations.html">animations</a> </li> <li> <a href="/tags/api.html">API</a> </li> <li> <a href="/tags/ariana-huffington.html">Ariana Huffington</a> </li> <li> <a href="/tags/art.html">art</a> </li> <li> <a href="/tags/buddhism.html">Buddhism</a> </li> <li> <a href="/tags/cards.html">cards</a> </li> <li> <a href="/tags/china.html">China</a> </li> <li> <a href="/tags/client.html">client</a> </li> <li> <a href="/tags/coupling.html">coupling</a> </li> <li> <a href="/tags/css.html">CSS</a> </li> <li> <a href="/tags/dates.html">dates</a> </li> <li> <a href="/tags/design.html">design</a> </li> <li> <a href="/tags/diana-smith.html">Diana Smith</a> </li> <li> <a href="/tags/documentation.html">documentation</a> </li> <li> <a href="/tags/dom.html">DOM</a> </li> <li> <a href="/tags/dry.html">DRY</a> </li> <li> <a href="/tags/ebooks.html">eBooks</a> </li> <li> <a href="/tags/editor-x.html">Editor X</a> </li> <li> <a href="/tags/epubcheck.html">epubcheck</a> </li> <li> <a href="/tags/event-listeners.html">event listeners</a> </li> <li> <a href="/tags/firebase.html">Firebase</a> </li> <li> <a href="/tags/free.html">free</a> </li> <li> <a href="/tags/free-downloads.html">free downloads</a> </li> <li> <a href="/tags/games.html">games</a> </li> <li> <a href="/tags/geolocation.html">geolocation</a> </li> <li> <a href="/tags/google-firebase.html">Google Firebase</a> </li> <li> <a href="/tags/google-maps.html">Google Maps</a> </li> <li> <a href="/tags/graphic-design.html">graphic design</a> </li> <li> <a href="/tags/hooks.html">hooks</a> </li> <li> <a href="/tags/html.html">HTML</a> </li> <li> <a href="/tags/http-restrictions.html">HTTP restrictions</a> </li> <li> <a href="/tags/innerheight.html">innerHeight</a> </li> <li> <a href="/tags/innovation.html">innovation</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/kabbalah.html">Kabbalah</a> </li> <li> <a href="/tags/landing-pages.html">landing pages</a> </li> <li> <a href="/tags/layouts.html">layouts</a> </li> <li> <a href="/tags/leaks.html">leaks</a> </li> <li> <a href="/tags/libraries.html">libraries</a> </li> <li> <a href="/tags/mushroom-observer.html">Mushroom Observer</a> </li> <li> <a href="/tags/mushrooms.html">mushrooms</a> </li> <li> <a href="/tags/nature.html">nature</a> </li> <li> <a href="/tags/npm.html">npm</a> </li> <li> <a href="/tags/offsetheight.html">offsetHeight</a> </li> <li> <a href="/tags/parallax-scrolling.html">parallax scrolling</a> </li> <li> <a href="/tags/pomodoro.html">Pomodoro</a> </li> <li> <a href="/tags/productivity.html">productivity</a> </li> <li> <a href="/tags/projects.html">projects</a> </li> <li> <a href="/tags/prova-lab.html">Prova Lab</a> </li> <li> <a href="/tags/pseudocode.html">pseudocode</a> </li> <li> <a href="/tags/react.html">React</a> </li> <li> <a href="/tags/san-francisco.html">San Francisco</a> </li> <li> <a href="/tags/sass.html">Sass</a> </li> <li> <a href="/tags/scrollheight.html">scrollHeight</a> </li> <li> <a href="/tags/security.html">security</a> </li> <li> <a href="/tags/taoism.html">Taoism</a> </li> <li> <a href="/tags/tarot.html">tarot</a> </li> <li> <a href="/tags/template-literals.html">template literals</a> </li> <li> <a href="/tags/validation.html">validation</a> </li> <li> <a href="/tags/vpn.html">VPN</a> </li> <li> <a href="/tags/webpack.html">Webpack</a> </li> <li> <a href="/tags/wix.html">Wix</a> </li> <li> <a href="/tags/wix-studio.html">Wix Studio</a> </li> <li> <a href="/tags/workflow.html">workflow</a> </li> <li> <a href="/tags/workouts.html">workouts</a> </li> <li> <a href="/tags/wysiwyg.html">wysiwyg</a> </li> <li> <a href="/tags/yin-and-yang.html">yin and yang</a> </li> </ul> </nav> <div class="social-icons"> <a class="sticky-contact-link" href="/contact"> contact me&nbsp; </a> <a href="https://twitter.com/alec4nandes" target="_blank" rel="noopener"> <img src="/assets/icons8-twitter-32.png" alt="Twitter icon of little bird"/> </a> <a href="https://instagram.com/alec4nandes" target="_blank" rel="noopener"> <img src="/assets/icons8-instagram-32.png" alt="Instagram icon of polaroid camera"/> </a> </div> </div> </div> <main> <article> <h2 class="title"> <a href="/blog/2-key-strategy.html">The 2-Key Strategy</a> </h2> <h3 class="subtitle">Keep your API keys safe when bundling client-side code.</h3> <p class="date-posted">2023-11-07T12:03-08:00</p> <figure> <img src="/blog/feature-images/scott-webb-lnRPKo7Lo5Q-unsplash-min.jpg" /> <figcaption>Photo by <a href="https://unsplash.com/@scottwebb?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash" target="_blank" rel="noopener">Scott Webb</a> on <a href="https://unsplash.com/photos/red-blue-and-green-hanging-decor-lnRPKo7Lo5Q?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash" target="_blank" rel="noopener">Unsplash</a></figcaption> </figure> <div><p> Let’s jump right in! </p> <h3> The Problem </h3> <p> Bundling React code with Webpack can leak API keys into JavaScript files on the client side. Sometimes it’s unavoidable, so how do we handle it?</p> <h3>The Solution</h3> <p> We should set HTTP restrictions for all API keys. Most API settings allow this, but it also creates a new problem. Sometimes we need to add <em>localhost</em> to the restricted list when developing locally. Anyone else using localhost and our same port – for example <em>http://localhost:3000</em> – can also use our API key. </p> <p> We can protect our data from this nasty loophole by using two separate keys: a public one for production and a private one for development. Anyone can view the production key <strong>as long as it’s restricted to only the production URL.</strong> Hackers cannot replicate your production URL like they can with localhost, so the production key won’t work for them. </p> <p> The development key must remain completely secret – no bundling it into the deployed front-end code or uploading it to GitHub. If this accidentally happens, change the key immediately. This way a hacker on localhost and the same port number won’t be able to access your data. </p> <p> I personally keep both keys in a file hidden by <em>.gitignore</em>, and in my JavaScript I have the variable “apiKey” that I export across my code. For example: </p> <pre><code><xmp>// add private-file.js to .gitignore
import { developmentKey, productionKey } from "./private-file.js";

const IS_DEVELOPMENT = false,
	apiKey = IS_DEVELOPMENT ? developmentKey : productionKey;

await fetch(`https://fern.haus/my-cool-api/?key=${apiKey}`);

export { apiKey };
</xmp></code></pre> <p> Now I just need to make sure the variable <em>IS_DEVELOPMENT</em> is set to “false” before I publish or deploy any changes. This way the development key never leaks into the code, and you don’t have to replace it over and over again across many files. Just change one variable! </p> <h3> Conclusion </h3> <p> When building a dynamic single page app using React and packages like <em>firebase</em>, the API key unavoidably leaks into the bundled client-side code. By setting HTTP restrictions on not just one but two keys, we can publicly display our restricted production key while safely developing on localhost using our private development key. Don’t let unwanted third parties abuse your API quotas – adopt the 2-key strategy today! </p></div> <div class="tags"> tags: <ul class="commas"> <li> <a href="/tags/api.html">API</a> </li> <li> <a href="/tags/security.html">security</a> </li> <li> <a href="/tags/http-restrictions.html">HTTP restrictions</a> </li> <li> <a href="/tags/leaks.html">leaks</a> </li> <li> <a href="/tags/javascript.html">JavaScript</a> </li> <li> <a href="/tags/react.html">React</a> </li> <li> <a href="/tags/webpack.html">Webpack</a> </li> <li> <a href="/tags/firebase.html">Firebase</a> </li> <li> <a href="/tags/npm.html">npm</a> </li> </ul> </div> <button class="share-button" data-id="2-key-strategy" onclick="copyLink(event)"> share <img src="/assets/icons8-share-24.png" alt="" /> </button> </article> </main> <a href="/contact" class="sticky-contact"> <img src="/assets/mail-icon.png" alt="" /> </a> <footer> <div id="footer-container"> <a href="/">home</a> <a href="/blog">blog</a> <a href="/contact">contact</a> </div> </footer> <script src="/src/scripts.js"></script> </body> </html>